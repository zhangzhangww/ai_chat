import{h as w}from"./request-C9YwD_7X.js";/* empty css                  *//* empty css                 *//* empty css                        */import{g as W}from"./promptType-DpiULCtq.js";import{J as X,r as C,A as I,o as Y,E as s,c as z,a as E,b as c,h as o,w as p,B as Z,D as ee,K as te,L as ae,C as oe,F as k,g as x,f as u,M as le,N as pe,t as re,O as ne,P as se,Q as ie,R as de,j as g,k as D,G as ue,_ as me}from"./index-BAb06sIO.js";const ce=()=>w.get("/chat/testPrompt/getPromptList"),ge=i=>w.post("/chat/testPrompt",i),fe=i=>w.put("/chat/testPrompt",i),ye=i=>w.delete(`/chat/testPrompt/${i}`),_e={class:"content-item"},ve={class:"search"},be={class:"search__left"},Ce={class:"search__right"},we={class:"page"},he={class:"page"},Ve=X({__name:"knowledge",setup(i){const h=C([]),V=C(),f=C(0),r=I({pageNum:1,pageSize:10,total:100}),S=C([{typeId:1,typeName:"语法检查"}]),l=I({dialogVisible:!1,isEdit:!1,form:{promptContent:"",promptTypeId:1,inputSpecialist:"",approveSpecialist:"",aiPromptContent:""}}),U=I({promptContent:[{required:!0,message:"内容不能为空"}],promptTypeId:[{required:!0,message:"请选择类型"}]});Y(()=>{y(),L()});const B=a=>{const e=new FormData;return Object.entries(a).forEach(([_,v])=>{e.append(_,String(v))}),e},y=async()=>{try{const{data:a}=await ce();r.total=a.total,h.value=a.data.map(e=>({...e,promptTypeId:Number(e.promptTypeId)}))}catch{s.error("获取数据失败")}},L=async()=>{try{const{data:a}=await W();S.value=[{typeId:0,typeName:"全部类型"},...a.data.map(e=>({typeId:Number(e.typeId),typeName:e.typeName}))]}catch{s.error("获取数据失败")}},F=a=>{y()},A=async()=>{try{await V.value.validate()}catch{s.warning("请正确填写表单");return}try{const a=B(l.form);l.isEdit?(await fe(a),s.success("更新成功")):(await ge(a),s.success("添加成功")),l.dialogVisible=!1,await y()}catch{s.error("操作失败")}},N=z(()=>f.value==0?h.value:h.value.filter(a=>a.promptTypeId==f.value)),M=z(()=>{const a=(r.pageNum-1)*r.pageSize,e=a+r.pageSize;return N.value.slice(a,e)}),$=()=>{l.isEdit=!1,l.form={promptContent:"",promptTypeId:38,inputSpecialist:"",approveSpecialist:"",aiPromptContent:"",promptId:0},l.dialogVisible=!0},O=a=>{r.pageNum=a},T=a=>{r.pageSize=a,r.pageNum=1},R=a=>{l.isEdit=!0,l.form={...a},l.dialogVisible=!0},j=async a=>{try{await de.confirm("确定删除该记录吗？","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}),await ye(a.promptId),s.success("删除成功"),await y()}catch{}},q=()=>{var a;(a=V.value)==null||a.resetFields()};return(a,e)=>{const _=ue,v=Z,m=ee,n=le,G=pe,J=te,P=ae,b=ie,d=se,K=ne,Q=oe;return g(),E("div",_e,[c("div",ve,[c("div",be,[o(v,{modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=t=>f.value=t),style:{width:"160px"}},{default:p(()=>[(g(!0),E(k,null,x(S.value,t=>(g(),D(_,{key:t.typeId,label:t.typeName,value:t.typeId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),c("div",Ce,[o(m,{type:"primary",onClick:$},{default:p(()=>e[11]||(e[11]=[u(" 新增数据 ")])),_:1})])]),o(J,{data:M.value,border:"",style:{width:"100%","max-height":"80%",overflow:"auto"}},{default:p(()=>[o(n,{label:"序号",type:"index",width:"60"}),o(n,{label:"编校知识",prop:"promptContent","show-overflow-tooltip":""}),o(n,{label:"类型",width:"120"},{default:p(({row:t})=>[o(G,{type:"primary"},{default:p(()=>[u(re(t.promptTypeName),1)]),_:2},1024)]),_:1}),o(n,{label:"录入专家",prop:"inputSpecialist",width:"120"}),o(n,{label:"批准专家",prop:"approveSpecialist",width:"120"}),o(n,{label:"AI提示词",prop:"aiPromptContent","show-overflow-tooltip":""}),o(n,{label:"创建日期",prop:"createTime",width:"180"}),o(n,{label:"操作",width:"180",fixed:"right"},{default:p(({row:t})=>[o(m,{size:"small",onClick:H=>R(t)},{default:p(()=>e[12]||(e[12]=[u("编辑")])),_:2},1032,["onClick"]),o(m,{size:"small",type:"danger",onClick:H=>j(t)},{default:p(()=>e[13]||(e[13]=[u("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),c("div",we,[o(P,{background:"",layout:"total, sizes, prev, pager, next",total:r.total,"page-size":r.pageSize,onCurrentChange:F,onSizeChange:T,"current-page":r.pageNum,"onUpdate:currentPage":e[1]||(e[1]=t=>r.pageNum=t)},null,8,["total","page-size","current-page"])]),c("div",he,[o(P,{background:"",layout:"total, sizes, prev, pager, next",total:N.value.length,"page-size":r.pageSize,"onUpdate:pageSize":e[2]||(e[2]=t=>r.pageSize=t),"current-page":r.pageNum,"onUpdate:currentPage":e[3]||(e[3]=t=>r.pageNum=t),onCurrentChange:O,onSizeChange:T},null,8,["total","page-size","current-page"])]),o(Q,{modelValue:l.dialogVisible,"onUpdate:modelValue":e[10]||(e[10]=t=>l.dialogVisible=t),title:l.isEdit?"编辑提示词":"新增提示词",width:"600px",onClosed:q},{default:p(()=>[o(K,{model:l.form,rules:U,ref_key:"formRef",ref:V,"label-width":"100px"},{default:p(()=>[o(d,{label:"编校知识：",prop:"promptContent"},{default:p(()=>[o(b,{modelValue:l.form.promptContent,"onUpdate:modelValue":e[4]||(e[4]=t=>l.form.promptContent=t),type:"textarea",rows:3,placeholder:"请输入提示词"},null,8,["modelValue"])]),_:1}),o(d,{label:"类型：",prop:"promptTypeId"},{default:p(()=>[o(v,{modelValue:l.form.promptTypeId,"onUpdate:modelValue":e[5]||(e[5]=t=>l.form.promptTypeId=t),placeholder:"请选择类型",style:{width:"100%"}},{default:p(()=>[(g(!0),E(k,null,x(S.value,t=>(g(),D(_,{key:t.typeId,label:t.typeName,value:t.typeId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(d,{label:"录入专家：",prop:"inputSpecialist"},{default:p(()=>[o(b,{modelValue:l.form.inputSpecialist,"onUpdate:modelValue":e[6]||(e[6]=t=>l.form.inputSpecialist=t),placeholder:"请输入录入专家"},null,8,["modelValue"])]),_:1}),o(d,{label:"批准专家：",prop:"approveSpecialist"},{default:p(()=>[o(b,{modelValue:l.form.approveSpecialist,"onUpdate:modelValue":e[7]||(e[7]=t=>l.form.approveSpecialist=t),placeholder:"请输入批准专家"},null,8,["modelValue"])]),_:1}),o(d,{label:"AI提示词：",prop:"aiPromptContent"},{default:p(()=>[o(b,{modelValue:l.form.aiPromptContent,"onUpdate:modelValue":e[8]||(e[8]=t=>l.form.aiPromptContent=t),type:"textarea",rows:3,placeholder:"请输入AI提示词"},null,8,["modelValue"])]),_:1}),o(d,{class:"dialog-footer"},{default:p(()=>[o(m,{onClick:e[9]||(e[9]=t=>l.dialogVisible=!1)},{default:p(()=>e[14]||(e[14]=[u("取 消")])),_:1}),o(m,{type:"primary",onClick:A},{default:p(()=>e[15]||(e[15]=[u("确 定")])),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),ze=me(Ve,[["__scopeId","data-v-62138aaa"]]);export{ze as default};
