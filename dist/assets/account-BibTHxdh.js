import"./request-BWjB7kre.js";/* empty css                  */import{g as W,u as X,a as Y,d as Z,s as ee}from"./aiChat-DLXiqbyH.js";import{g as te}from"./promptType-sp0Rc7oK.js";import{C as ae,r as C,y as S,j as oe,E as p,z as x,c as I,a as c,e as o,w as n,A as le,D as ne,G as re,H as pe,I as se,o as f,B as ie,F as z,d as N,g as k,h as i,J as de,K as ue,t as me,L as ce,M as fe,N as ge,O as P,_ as ye}from"./index-CclMgo0x.js";const _e={class:"content-item"},ve={class:"search"},be={class:"search__left"},Ce={class:"search__right"},we={class:"page"},Ve={class:"page"},Se=ae({__name:"account",setup(Ie){const w=C([]),V=C(),g=C(0),r=S({pageNum:1,pageSize:10,total:100}),y=C([{typeId:1,typeName:"语法检查"}]),l=S({dialogVisible:!1,isEdit:!1,form:{promptContent:"",promptTypeId:1,inputSpecialist:"",approveSpecialist:"",aiPromptContent:""}}),B=S({promptContent:[{required:!0,message:"内容不能为空"}],promptTypeId:[{required:!0,message:"请选择类型"}]});oe(()=>{_(),U()});const D=t=>{const e=new FormData;return Object.entries(t).forEach(([m,v])=>{e.append(m,String(v))}),e},_=async()=>{try{const{data:t}=await W();r.total=t.total,w.value=t.data.map(e=>({...e,promptTypeId:Number(e.promptTypeId)}))}catch{p.error("获取数据失败")}},U=async()=>{try{const{data:t}=await te();y.value=t.data.map(e=>({typeId:Number(e.typeId),typeName:e.typeName}))}catch{p.error("获取数据失败")}},F=async()=>{try{await P.confirm("确定要备份所有提示词数据吗？","备份确认",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"});const t=await ee();console.log(t),t.data.code===200?p.success("备份成功"):p.error("备份失败")}catch(t){t!=="cancel"&&p.error("备份过程中出错: "+(t.message||"未知错误"))}},L=t=>{_()},A=async()=>{try{await V.value.validate()}catch{p.warning("请正确填写表单");return}try{const t=D(l.form);l.isEdit?(await X(t),p.success("更新成功")):(await Y(t),p.success("添加成功")),l.dialogVisible=!1,await _()}catch{p.error("操作失败")}},h=x(()=>g.value==0?w.value:w.value.filter(t=>t.promptTypeId==g.value)),M=x(()=>{const t=(r.pageNum-1)*r.pageSize,e=t+r.pageSize;return h.value.slice(t,e)}),O=()=>{l.isEdit=!1,l.form={promptContent:"",promptTypeId:y.value[0].typeId,inputSpecialist:"",approveSpecialist:"",aiPromptContent:"",promptId:0},l.dialogVisible=!0},$=t=>{r.pageNum=t},T=t=>{r.pageSize=t,r.pageNum=1},j=t=>{l.isEdit=!0,l.form={...t},l.dialogVisible=!0},q=async t=>{try{await P.confirm("确定删除该记录吗？","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}),await Z(t.promptId),p.success("删除成功"),await _()}catch{}},R=()=>{var t;(t=V.value)==null||t.resetFields()};return(t,e)=>{const m=ie,v=le,d=ne,s=de,G=ue,H=re,E=pe,b=ge,u=fe,J=ce,K=se;return f(),I("div",_e,[c("div",ve,[c("div",be,[o(v,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=a=>g.value=a),style:{width:"160px"}},{default:n(()=>[o(m,{label:"全部类型",value:0}),(f(!0),I(z,null,N(y.value,a=>(f(),k(m,{key:a.typeId,label:a.typeName,value:a.typeId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),c("div",Ce,[o(d,{onClick:F},{default:n(()=>e[11]||(e[11]=[i(" 一键备份 ")])),_:1}),o(d,{type:"primary",onClick:O},{default:n(()=>e[12]||(e[12]=[i(" 新增数据 ")])),_:1})])]),o(H,{data:M.value,border:"",style:{width:"100%","max-height":"80%",overflow:"auto"}},{default:n(()=>[o(s,{label:"序号",type:"index",width:"60"}),o(s,{label:"编校知识",prop:"promptContent","show-overflow-tooltip":""}),o(s,{label:"类型",width:"120"},{default:n(({row:a})=>[o(G,{type:"primary"},{default:n(()=>[i(me(a.promptTypeName),1)]),_:2},1024)]),_:1}),o(s,{label:"录入专家",prop:"inputSpecialist",width:"120"}),o(s,{label:"批准专家",prop:"approveSpecialist",width:"120"}),o(s,{label:"创建日期",prop:"createTime",width:"180"}),o(s,{label:"操作",width:"180",fixed:"right"},{default:n(({row:a})=>[o(d,{size:"small",onClick:Q=>j(a)},{default:n(()=>e[13]||(e[13]=[i("编辑")])),_:2},1032,["onClick"]),o(d,{size:"small",type:"danger",onClick:Q=>q(a)},{default:n(()=>e[14]||(e[14]=[i("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),c("div",we,[o(E,{background:"",layout:"total, sizes, prev, pager, next",total:r.total,"page-size":r.pageSize,onCurrentChange:L,onSizeChange:T,"current-page":r.pageNum,"onUpdate:currentPage":e[1]||(e[1]=a=>r.pageNum=a)},null,8,["total","page-size","current-page"])]),c("div",Ve,[o(E,{background:"",layout:"total, sizes, prev, pager, next",total:h.value.length,"page-size":r.pageSize,"onUpdate:pageSize":e[2]||(e[2]=a=>r.pageSize=a),"current-page":r.pageNum,"onUpdate:currentPage":e[3]||(e[3]=a=>r.pageNum=a),onCurrentChange:$,onSizeChange:T},null,8,["total","page-size","current-page"])]),o(K,{modelValue:l.dialogVisible,"onUpdate:modelValue":e[10]||(e[10]=a=>l.dialogVisible=a),title:l.isEdit?"编辑提示词":"新增提示词",width:"600px",onClosed:R},{default:n(()=>[o(J,{model:l.form,rules:B,ref_key:"formRef",ref:V,"label-width":"100px"},{default:n(()=>[o(u,{label:"编校知识：",prop:"promptContent"},{default:n(()=>[o(b,{modelValue:l.form.promptContent,"onUpdate:modelValue":e[4]||(e[4]=a=>l.form.promptContent=a),type:"textarea",rows:3,placeholder:"请输入提示词"},null,8,["modelValue"])]),_:1}),o(u,{label:"类型：",prop:"promptTypeId"},{default:n(()=>[o(v,{modelValue:l.form.promptTypeId,"onUpdate:modelValue":e[5]||(e[5]=a=>l.form.promptTypeId=a),placeholder:"请选择类型",style:{width:"100%"}},{default:n(()=>[(f(!0),I(z,null,N(y.value,a=>(f(),k(m,{key:a.typeId,label:a.typeName,value:a.typeId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(u,{label:"录入专家：",prop:"inputSpecialist"},{default:n(()=>[o(b,{modelValue:l.form.inputSpecialist,"onUpdate:modelValue":e[6]||(e[6]=a=>l.form.inputSpecialist=a),placeholder:"请输入录入专家"},null,8,["modelValue"])]),_:1}),o(u,{label:"批准专家：",prop:"approveSpecialist"},{default:n(()=>[o(b,{modelValue:l.form.approveSpecialist,"onUpdate:modelValue":e[7]||(e[7]=a=>l.form.approveSpecialist=a),placeholder:"请输入批准专家"},null,8,["modelValue"])]),_:1}),o(u,{label:"AI提示词：",prop:"aiPromptContent"},{default:n(()=>[o(b,{modelValue:l.form.aiPromptContent,"onUpdate:modelValue":e[8]||(e[8]=a=>l.form.aiPromptContent=a),type:"textarea",rows:3,placeholder:"请输入AI提示词"},null,8,["modelValue"])]),_:1}),o(u,{class:"dialog-footer"},{default:n(()=>[o(d,{onClick:e[9]||(e[9]=a=>l.dialogVisible=!1)},{default:n(()=>e[15]||(e[15]=[i("取 消")])),_:1}),o(d,{type:"primary",onClick:A},{default:n(()=>e[16]||(e[16]=[i("确 定")])),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),Ne=ye(Se,[["__scopeId","data-v-f68a26cc"]]);export{Ne as default};
