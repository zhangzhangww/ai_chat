import"./request-C9YwD_7X.js";/* empty css                  *//* empty css                 *//* empty css                        */import{g as W,u as X,a as Y,d as Z,s as ee}from"./aiChat-D0S83BrT.js";import{g as te}from"./promptType-DpiULCtq.js";import{J as ae,r as C,A as S,o as oe,E as p,c as x,a as h,b as c,h as o,w as r,B as le,D as re,K as ne,L as pe,C as se,j as f,G as ie,F as N,g as z,k,f as i,M as de,N as ue,t as me,O as ce,P as fe,Q as ge,R as P,_ as ye}from"./index-BAb06sIO.js";const _e={class:"content-item"},ve={class:"search"},be={class:"search__left"},Ce={class:"search__right"},we={class:"page"},Ve={class:"page"},Se=ae({__name:"account",setup(he){const w=C([]),V=C(),g=C(0),n=S({pageNum:1,pageSize:10,total:100}),y=C([{typeId:1,typeName:"语法检查"}]),l=S({dialogVisible:!1,isEdit:!1,form:{promptContent:"",promptTypeId:1,inputSpecialist:"",approveSpecialist:"",aiPromptContent:""}}),B=S({promptContent:[{required:!0,message:"内容不能为空"}],promptTypeId:[{required:!0,message:"请选择类型"}]});oe(()=>{_(),U()});const D=t=>{const e=new FormData;return Object.entries(t).forEach(([m,v])=>{e.append(m,String(v))}),e},_=async()=>{try{const{data:t}=await W();n.total=t.total,w.value=t.data.map(e=>({...e,promptTypeId:Number(e.promptTypeId)}))}catch{p.error("获取数据失败")}},U=async()=>{try{const{data:t}=await te();y.value=t.data.map(e=>({typeId:Number(e.typeId),typeName:e.typeName}))}catch{p.error("获取数据失败")}},F=async()=>{try{await P.confirm("确定要备份所有提示词数据吗？","备份确认",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"});const t=await ee();console.log(t),t.data.code===200?p.success("备份成功"):p.error("备份失败")}catch(t){t!=="cancel"&&p.error("备份过程中出错: "+(t.message||"未知错误"))}},L=t=>{_()},A=async()=>{try{await V.value.validate()}catch{p.warning("请正确填写表单");return}try{const t=D(l.form);l.isEdit?(await X(t),p.success("更新成功")):(await Y(t),p.success("添加成功")),l.dialogVisible=!1,await _()}catch{p.error("操作失败")}},I=x(()=>g.value==0?w.value:w.value.filter(t=>t.promptTypeId==g.value)),M=x(()=>{const t=(n.pageNum-1)*n.pageSize,e=t+n.pageSize;return I.value.slice(t,e)}),O=()=>{l.isEdit=!1,l.form={promptContent:"",promptTypeId:y.value[0].typeId,inputSpecialist:"",approveSpecialist:"",aiPromptContent:"",promptId:0},l.dialogVisible=!0},R=t=>{n.pageNum=t},T=t=>{n.pageSize=t,n.pageNum=1},$=t=>{l.isEdit=!0,l.form={...t},l.dialogVisible=!0},j=async t=>{try{await P.confirm("确定删除该记录吗？","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}),await Z(t.promptId),p.success("删除成功"),await _()}catch{}},q=()=>{var t;(t=V.value)==null||t.resetFields()};return(t,e)=>{const m=ie,v=le,d=re,s=de,G=ue,J=ne,E=pe,b=ge,u=fe,K=ce,Q=se;return f(),h("div",_e,[c("div",ve,[c("div",be,[o(v,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=a=>g.value=a),style:{width:"160px"}},{default:r(()=>[o(m,{label:"全部类型",value:0}),(f(!0),h(N,null,z(y.value,a=>(f(),k(m,{key:a.typeId,label:a.typeName,value:a.typeId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),c("div",Ce,[o(d,{onClick:F},{default:r(()=>e[11]||(e[11]=[i(" 一键备份 ")])),_:1}),o(d,{type:"primary",onClick:O},{default:r(()=>e[12]||(e[12]=[i(" 新增数据 ")])),_:1})])]),o(J,{data:M.value,border:"",style:{width:"100%","max-height":"80%",overflow:"auto"}},{default:r(()=>[o(s,{label:"序号",type:"index",width:"60"}),o(s,{label:"编校知识",prop:"promptContent","show-overflow-tooltip":""}),o(s,{label:"类型",width:"120"},{default:r(({row:a})=>[o(G,{type:"primary"},{default:r(()=>[i(me(a.promptTypeName),1)]),_:2},1024)]),_:1}),o(s,{label:"录入专家",prop:"inputSpecialist",width:"120"}),o(s,{label:"批准专家",prop:"approveSpecialist",width:"120"}),o(s,{label:"创建日期",prop:"createTime",width:"180"}),o(s,{label:"操作",width:"180",fixed:"right"},{default:r(({row:a})=>[o(d,{size:"small",onClick:H=>$(a)},{default:r(()=>e[13]||(e[13]=[i("编辑")])),_:2},1032,["onClick"]),o(d,{size:"small",type:"danger",onClick:H=>j(a)},{default:r(()=>e[14]||(e[14]=[i("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),c("div",we,[o(E,{background:"",layout:"total, sizes, prev, pager, next",total:n.total,"page-size":n.pageSize,onCurrentChange:L,onSizeChange:T,"current-page":n.pageNum,"onUpdate:currentPage":e[1]||(e[1]=a=>n.pageNum=a)},null,8,["total","page-size","current-page"])]),c("div",Ve,[o(E,{background:"",layout:"total, sizes, prev, pager, next",total:I.value.length,"page-size":n.pageSize,"onUpdate:pageSize":e[2]||(e[2]=a=>n.pageSize=a),"current-page":n.pageNum,"onUpdate:currentPage":e[3]||(e[3]=a=>n.pageNum=a),onCurrentChange:R,onSizeChange:T},null,8,["total","page-size","current-page"])]),o(Q,{modelValue:l.dialogVisible,"onUpdate:modelValue":e[10]||(e[10]=a=>l.dialogVisible=a),title:l.isEdit?"编辑提示词":"新增提示词",width:"600px",onClosed:q},{default:r(()=>[o(K,{model:l.form,rules:B,ref_key:"formRef",ref:V,"label-width":"100px"},{default:r(()=>[o(u,{label:"编校知识：",prop:"promptContent"},{default:r(()=>[o(b,{modelValue:l.form.promptContent,"onUpdate:modelValue":e[4]||(e[4]=a=>l.form.promptContent=a),type:"textarea",rows:3,placeholder:"请输入提示词"},null,8,["modelValue"])]),_:1}),o(u,{label:"类型：",prop:"promptTypeId"},{default:r(()=>[o(v,{modelValue:l.form.promptTypeId,"onUpdate:modelValue":e[5]||(e[5]=a=>l.form.promptTypeId=a),placeholder:"请选择类型",style:{width:"100%"}},{default:r(()=>[(f(!0),h(N,null,z(y.value,a=>(f(),k(m,{key:a.typeId,label:a.typeName,value:a.typeId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(u,{label:"录入专家：",prop:"inputSpecialist"},{default:r(()=>[o(b,{modelValue:l.form.inputSpecialist,"onUpdate:modelValue":e[6]||(e[6]=a=>l.form.inputSpecialist=a),placeholder:"请输入录入专家"},null,8,["modelValue"])]),_:1}),o(u,{label:"批准专家：",prop:"approveSpecialist"},{default:r(()=>[o(b,{modelValue:l.form.approveSpecialist,"onUpdate:modelValue":e[7]||(e[7]=a=>l.form.approveSpecialist=a),placeholder:"请输入批准专家"},null,8,["modelValue"])]),_:1}),o(u,{label:"AI提示词：",prop:"aiPromptContent"},{default:r(()=>[o(b,{modelValue:l.form.aiPromptContent,"onUpdate:modelValue":e[8]||(e[8]=a=>l.form.aiPromptContent=a),type:"textarea",rows:3,placeholder:"请输入AI提示词"},null,8,["modelValue"])]),_:1}),o(u,{class:"dialog-footer"},{default:r(()=>[o(d,{onClick:e[9]||(e[9]=a=>l.dialogVisible=!1)},{default:r(()=>e[15]||(e[15]=[i("取 消")])),_:1}),o(d,{type:"primary",onClick:A},{default:r(()=>e[16]||(e[16]=[i("确 定")])),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),Pe=ye(Se,[["__scopeId","data-v-446ee6fb"]]);export{Pe as default};
